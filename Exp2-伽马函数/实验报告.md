伽马函数数值计算实验报告
 
1. 实验目的
 
本次实验旨在学习并运用数值积分方法，借助变量代换技术计算伽马函数 \Gamma(a) 的值，并对其性质进行验证。
 
2. 实验方法
 
2.1 被积函数可视化
 
利用 Python 的  numpy  和  matplotlib  库，绘制伽马函数被积函数 f(x, a) = x^{a - 1} e^{-x} 在 a = 2, 3, 4 时于区间 x \in [0, 10] 的图像，直观呈现函数形态。
 
2.2 变量代换
 
为提升数值积分精度，采用变量代换 z = \frac{x}{c + x}，其中 c = a - 1，将原本在 [0, \infty) 的积分区间变换到 [0, 1) 。推导出变换后的被积函数 g(z, a) ：
g(z, a) = \left[ \frac{cz}{1 - z} \right]^{a - 1} e^{-\frac{cz}{1 - z}} \cdot \frac{c}{(1 - z)^2} ，也可采用对数优化形式 g(z, a) = \exp\left((a - 1)\log\left(\frac{cz}{1 - z}\right) - \frac{cz}{1 - z}\right) \cdot \frac{c}{(1 - z)^2} ，这里 c = a - 1 。
 
2.3 数值积分方法
 
构建  gamma_function(a)  函数，运用高斯 - 勒让德积分（选取合适点数）来计算变换后的积分 \int_0^1 g(z, a) dz ，实现对伽马函数值的求解。
 
3. 实验结果
   
 ![Image_1746931044185](https://github.com/user-attachments/assets/c0493c00-905a-4f2c-b10a-c947532b7b2b)

3.1 被积函数图像
 
绘制出的图像展示了 a = 2, 3, 4 时被积函数的情况 。从图中可以看出：
 
- 当 a = 2 时，函数 f(x, 2) = x e^{-x} ，在 x = 1 处达到峰值，函数从 x = 0 处值为 0 开始上升，到达峰值后逐渐下降趋近于 0 。
- 当 a = 3 时，函数 f(x, 3) = x^{2} e^{-x} ，峰值位于 x = 2 处 ，相较于 a = 2 时，在相同 x 取值下函数值更大，且衰减更为迅速。
- 当 a = 4 时，函数 f(x, 4) = x^{3} e^{-x} ，峰值出现在 x = 3 处 ，在 x 较小时增长更快，在 x 较大时衰减也更明显。
 
3.2 Γ(1.5) 计算结果
 
表格
  
计算量 数值 
计算值 0.88622693 
精确值 0.88622693 
相对误差 1.87e - 14 
 
3.3 整数 Γ(a) 计算结果
 
表格
  
a 计算值 Γ(a) 精确值 (a - 1)! 相对误差 
3 2.000000e + 00 2 0.00e + 00 
6 1.200000e + 02 120 1.18e - 16 
10 3.628800e + 05 362880 3.21e - 16 
 
4. 分析与讨论
 
4.1 峰值位置推导
 
对 f(x, a) = x^{a - 1} e^{-x} 求导，依据乘积求导法则 (uv)^\prime = u^\prime v + uv^\prime ，其中 u = x^{a - 1} ，v = e^{-x} 。可得 u^\prime = (a - 1)x^{a - 2} ，v^\prime = -e^{-x} ，进而 f^\prime(x, a) = (a - 1)x^{a - 2} e^{-x} - x^{a - 1} e^{-x} = x^{a - 2} e^{-x}((a - 1) - x) 。令 f^\prime(x, a) = 0 ，由于 x^{a - 2} e^{-x} 在 x > 0 时恒大于 0 ，所以 (a - 1) - x = 0 ，解得 x = a - 1 ，这与图像中峰值位置相符。
 
4.2 变量代换推导
 
当 z = \frac{1}{2} 时，由 z = \frac{x}{c + x} 可推出 \frac{1}{2} = \frac{x}{c + x} ，即 c + x = 2x ，从而 x = c 。为使峰值 x = a - 1 对应到 z = \frac{1}{2} ，则需 c = x = a - 1 ，通过这样的变量代换实现了积分区间的转换。
 
4.3 结果讨论
 
从计算结果可知，对于 \Gamma(1.5) ，计算值与精确值高度吻合，相对误差极小，仅为 1.87e - 14 ，表明所选的高斯 - 勒让德积分结合变量代换的方法在计算伽马函数值时具有极高的准确性。对于整数 a 的伽马函数计算，相对误差同样微乎其微，如 a = 3 时相对误差为 0 ，a = 6 时为 1.18e - 16 ，a = 10 时为 3.21e - 16 ，有力验证了伽马函数在整数处的阶乘性质。在整个数值计算过程中，变量代换成功将无穷区间的积分转化为有限区间，有效提升了计算的稳定性与精度，同时高斯 - 勒让德积分在合适点数配置下，能精准逼近积分值，未出现明显数值问题。
 
5. 结论
 
本次实验借助变量代换和高斯 - 勒让德积分方法，成功实现了伽马函数值的精确计算，并对其在整数处的阶乘性质予以验证。通过绘制被积函数图像，清晰洞察到峰值位置随 a 的变化规律。变量代换技术有效化解了积分区间为无穷带来的计算难题，增强了计算的精度与稳定性；高斯 - 勒让德积分方法在合理点数设定下，能准确计算积分值，计算结果的相对误差极低，展现出良好的精度。通过本次实验，深化了对伽马函数计算方法和性质的理解，也积累了数值积分方法在实际应用中的经验。
